import{u as ve,a as d,N as V,O as p,P as m,s as Se,l as Ce,b as we,j as e,L as _,Q as $e,R as Q,S as De,d as K,T as Pe,x as ke,U as Ie,V as Fe,h as W}from"./index-CR2cQI6u.js";const n={card:{light:"bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-sm dark:shadow-lg dark:shadow-black/25 hover:shadow-md dark:shadow-xl dark:shadow-black/25 transition-all duration-200",dark:"bg-gray-900 border border-gray-800 shadow-lg dark:shadow-2xl dark:shadow-black/25 hover:shadow-xl transition-all duration-200",unified:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 shadow-sm dark:shadow-lg dark:shadow-2xl dark:shadow-black/25 hover:shadow-md dark:hover:shadow-xl transition-all duration-200"},input:{base:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 dark:placeholder-gray-500 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-200",error:"border-red-500 dark:border-red-400 focus:ring-red-500 dark:focus:ring-red-400",success:"border-green-500 dark:border-green-400 focus:ring-green-500 dark:focus:ring-green-400"}},Re={},X={},Ke=()=>{const{user:Ae}=ve(),[T,U]=d.useState([]),[P,k]=d.useState(!0),[Te,G]=d.useState(null),[ee,j]=d.useState(!1),[I,F]=d.useState(null),[h,R]=d.useState(null),[ae,A]=d.useState(!1),[Le,ne]=d.useState([]),[Be,te]=d.useState([]),[Ee,se]=d.useState([]),[y,q]=d.useState({status:"",startDate:"",endDate:"",clientEmail:"",invoiceNumber:""}),[O,le]=d.useState(!1),[N,b]=d.useState({amount:"",method:"Bank Transfer",reference:"",notes:""}),[r,u]=d.useState({companyInfo:{name:"Traincape Technology",logo:V,address:{street:"Khandolia Plaza, 118C, Dabri - Palam Rd, Vaishali, Vaishali Colony, Dashrath Puri",city:"New Delhi",state:"Delhi",zipCode:"110045",country:"India"},gstin:"07AAJCT0342G1ZJ",pan:"AAJCT0342G",email:"sales@traincapetech.in",phone:"+44 1253 928501",website:"https://traincapetech.in/"},clientInfo:{name:"",company:"",address:{street:"N/A",city:"N/A",state:"N/A",zipCode:"N/A",country:"N/A"},email:"",phone:""},paymentTerms:"Due on Receipt",customPaymentTerms:"",currency:"INR",currencySymbol:"₹",items:[{description:"",quantity:1,unitPrice:0,taxRate:18,discount:0,discountType:"percentage"}],notes:"",terms:"Payment is due within the specified terms. Late payments may incur additional charges.",relatedSale:"",relatedLead:""}),L={USD:{symbol:"$",name:"US Dollar"},EUR:{symbol:"€",name:"Euro"},GBP:{symbol:"£",name:"British Pound"},JPY:{symbol:"¥",name:"Japanese Yen"},CNY:{symbol:"¥",name:"Chinese Yuan"},INR:{symbol:"₹",name:"Indian Rupee"},CAD:{symbol:"C$",name:"Canadian Dollar"},MXN:{symbol:"MX$",name:"Mexican Peso"},CHF:{symbol:"CHF",name:"Swiss Franc"},SEK:{symbol:"kr",name:"Swedish Krona"},NOK:{symbol:"kr",name:"Norwegian Krone"},DKK:{symbol:"kr",name:"Danish Krone"},PLN:{symbol:"zł",name:"Polish Złoty"},CZK:{symbol:"Kč",name:"Czech Koruna"},HUF:{symbol:"Ft",name:"Hungarian Forint"},RUB:{symbol:"₽",name:"Russian Ruble"},TRY:{symbol:"₺",name:"Turkish Lira"},BGN:{symbol:"лв",name:"Bulgarian Lev"},RON:{symbol:"lei",name:"Romanian Leu"},HRK:{symbol:"kn",name:"Croatian Kuna"},RSD:{symbol:"дин",name:"Serbian Dinar"},UAH:{symbol:"₴",name:"Ukrainian Hryvnia"},AUD:{symbol:"A$",name:"Australian Dollar"},NZD:{symbol:"NZ$",name:"New Zealand Dollar"},SGD:{symbol:"S$",name:"Singapore Dollar"},HKD:{symbol:"HK$",name:"Hong Kong Dollar"},KRW:{symbol:"₩",name:"South Korean Won"},TWD:{symbol:"NT$",name:"Taiwan Dollar"},THB:{symbol:"฿",name:"Thai Baht"},MYR:{symbol:"RM",name:"Malaysian Ringgit"},IDR:{symbol:"Rp",name:"Indonesian Rupiah"},PHP:{symbol:"₱",name:"Philippine Peso"},VND:{symbol:"₫",name:"Vietnamese Dong"},BDT:{symbol:"৳",name:"Bangladeshi Taka"},PKR:{symbol:"₨",name:"Pakistani Rupee"},LKR:{symbol:"Rs",name:"Sri Lankan Rupee"},NPR:{symbol:"₨",name:"Nepalese Rupee"},MMK:{symbol:"K",name:"Myanmar Kyat"},KHR:{symbol:"៛",name:"Cambodian Riel"},LAK:{symbol:"₭",name:"Lao Kip"},MNT:{symbol:"₮",name:"Mongolian Tugrik"},AED:{symbol:"د.إ",name:"UAE Dirham"},SAR:{symbol:"﷼",name:"Saudi Riyal"},QAR:{symbol:"ر.ق",name:"Qatari Riyal"},KWD:{symbol:"د.ك",name:"Kuwaiti Dinar"},BHD:{symbol:".د.ب",name:"Bahraini Dinar"},OMR:{symbol:"ر.ع.",name:"Omani Rial"},JOD:{symbol:"د.ا",name:"Jordanian Dinar"},LBP:{symbol:"ل.ل",name:"Lebanese Pound"},EGP:{symbol:"ج.م",name:"Egyptian Pound"},ZAR:{symbol:"R",name:"South African Rand"},NGN:{symbol:"₦",name:"Nigerian Naira"},KES:{symbol:"KSh",name:"Kenyan Shilling"},GHS:{symbol:"GH₵",name:"Ghanaian Cedi"},UGX:{symbol:"USh",name:"Ugandan Shilling"},TZS:{symbol:"TSh",name:"Tanzanian Shilling"},ETB:{symbol:"Br",name:"Ethiopian Birr"},MAD:{symbol:"د.م.",name:"Moroccan Dirham"},TND:{symbol:"د.ت",name:"Tunisian Dinar"},DZD:{symbol:"د.ج",name:"Algerian Dinar"},LYD:{symbol:"ل.د",name:"Libyan Dinar"},SDG:{symbol:"ج.س.",name:"Sudanese Pound"},SOS:{symbol:"S",name:"Somali Shilling"},DJF:{symbol:"Fdj",name:"Djiboutian Franc"},KMF:{symbol:"CF",name:"Comorian Franc"},MUR:{symbol:"₨",name:"Mauritian Rupee"},SCR:{symbol:"₨",name:"Seychellois Rupee"},MVR:{symbol:"ރ.",name:"Maldivian Rufiyaa"},CVE:{symbol:"$",name:"Cape Verdean Escudo"},STD:{symbol:"Db",name:"São Tomé and Príncipe Dobra"},GMD:{symbol:"D",name:"Gambian Dalasi"},GNF:{symbol:"FG",name:"Guinean Franc"},SLL:{symbol:"Le",name:"Sierra Leonean Leone"},LRD:{symbol:"L$",name:"Liberian Dollar"},XOF:{symbol:"CFA",name:"West African CFA Franc"},XAF:{symbol:"FCFA",name:"Central African CFA Franc"},XPF:{symbol:"CFP",name:"CFP Franc"},ARS:{symbol:"$",name:"Argentine Peso"},CLP:{symbol:"$",name:"Chilean Peso"},COP:{symbol:"$",name:"Colombian Peso"},PEN:{symbol:"S/",name:"Peruvian Sol"},UYU:{symbol:"$",name:"Uruguayan Peso"},PYG:{symbol:"₲",name:"Paraguayan Guaraní"},BOB:{symbol:"Bs.",name:"Bolivian Boliviano"},VES:{symbol:"Bs.",name:"Venezuelan Bolívar"},GYD:{symbol:"$",name:"Guyanese Dollar"},SRD:{symbol:"$",name:"Surinamese Dollar"},FKP:{symbol:"£",name:"Falkland Islands Pound"},GTQ:{symbol:"Q",name:"Guatemalan Quetzal"},HNL:{symbol:"L",name:"Honduran Lempira"},NIO:{symbol:"C$",name:"Nicaraguan Córdoba"},CRC:{symbol:"₡",name:"Costa Rican Colón"},PAB:{symbol:"B/.",name:"Panamanian Balboa"},BZD:{symbol:"BZ$",name:"Belize Dollar"},JMD:{symbol:"J$",name:"Jamaican Dollar"},TTD:{symbol:"TT$",name:"Trinidad and Tobago Dollar"},BBD:{symbol:"Bds$",name:"Barbadian Dollar"},XCD:{symbol:"EC$",name:"East Caribbean Dollar"},AWG:{symbol:"ƒ",name:"Aruban Florin"},ANG:{symbol:"ƒ",name:"Netherlands Antillean Guilder"},KYD:{symbol:"CI$",name:"Cayman Islands Dollar"},BMD:{symbol:"BD$",name:"Bermudian Dollar"},ILS:{symbol:"₪",name:"Israeli Shekel"},CLF:{symbol:"UF",name:"Chilean Unit of Account"},KZT:{symbol:"₸",name:"Kazakhstani Tenge"},UZS:{symbol:"som",name:"Uzbekistani Som"},TJS:{symbol:"ЅM",name:"Tajikistani Somoni"},TMT:{symbol:"T",name:"Turkmenistani Manat"},GEL:{symbol:"₾",name:"Georgian Lari"},AMD:{symbol:"֏",name:"Armenian Dram"},AZN:{symbol:"₼",name:"Azerbaijani Manat"},BYN:{symbol:"Br",name:"Belarusian Ruble"},MDL:{symbol:"L",name:"Moldovan Leu"},ALL:{symbol:"L",name:"Albanian Lek"},MKD:{symbol:"ден",name:"Macedonian Denar"},BAM:{symbol:"KM",name:"Bosnia-Herzegovina Convertible Mark"},MOP:{symbol:"MOP$",name:"Macanese Pataca"},KGS:{symbol:"с",name:"Kyrgyzstani Som"},AFN:{symbol:"؋",name:"Afghan Afghani"},IRR:{symbol:"﷼",name:"Iranian Rial"},IQD:{symbol:"ع.د",name:"Iraqi Dinar"},YER:{symbol:"﷼",name:"Yemeni Rial"},SYP:{symbol:"£",name:"Syrian Pound"}};d.useEffect(()=>{v(),re(),oe(),ie()},[]);const v=async()=>{try{k(!0);const a=await p.getAll(y);a.data.success?U(a.data.data):(G("Failed to fetch invoices"),m.error("Failed to fetch invoices"))}catch(a){console.error("Error fetching invoices:",a),G("Failed to fetch invoices"),m.error("Failed to fetch invoices")}finally{k(!1)}},re=async()=>{try{const a=await Se.getAll();a.data.success&&ne(a.data.data)}catch(a){console.error("Error fetching sales:",a)}},oe=async()=>{try{const a=await Ce.getAll();a.data.success&&te(a.data.data)}catch(a){console.error("Error fetching leads:",a)}},ie=async()=>{try{const a=await we.getUsers("Sales Person");a.data.success&&se(a.data.data)}catch(a){console.error("Error fetching sales persons:",a)}};d.useEffect(()=>{v()},[y]);const S=a=>{const{name:t,value:l}=a.target;q(s=>({...s,[t]:l}))},de=()=>{q({status:"",startDate:"",endDate:"",clientEmail:"",invoiceNumber:""})},c=(a,t,l)=>{u(a?s=>({...s,[a]:{...s[a],[t]:l}}):s=>({...s,[t]:l})),t==="currency"&&L[l]&&u(s=>({...s,currencySymbol:L[l].symbol}))},C=(a,t,l)=>{u(s=>({...s,[a]:{...s[a],address:{...s[a].address,[t]:l}}}))},w=(a,t,l)=>{u(s=>({...s,items:s.items.map((i,x)=>{if(x===a){const g=["quantity","unitPrice","taxRate","discount"].includes(t)?parseFloat(l)||0:l;return{...i,[t]:g}}return i})}))},ce=()=>{u(a=>({...a,items:[...a.items,{description:"",quantity:1,unitPrice:0,taxRate:18,discount:0,discountType:"percentage"}]}))},me=a=>{r.items.length>1&&u(t=>({...t,items:t.items.filter((l,s)=>s!==a)}))},z=a=>{const t=parseFloat(a.quantity)||0,l=parseFloat(a.unitPrice)||0,s=parseFloat(a.taxRate)||0,i=parseFloat(a.discount)||0,x=t*l,$=a.discountType==="percentage"?x*i/100:i,g=x-$,D=g*(s/100),o=g+D;return isNaN(o)?0:o},ue=()=>{const a=r.items.reduce((t,l)=>t+z(l),0);return isNaN(a)?0:a},xe=async a=>{var t,l;a.preventDefault(),k(!0);try{if(!r.clientInfo.name||!r.clientInfo.email)throw new Error("Client name and email are required");if(r.items.some(o=>!o.description||!o.unitPrice||o.unitPrice<=0))throw new Error("All items must have description and valid unit price");const s={...r,items:r.items.map(o=>{const f=parseFloat(o.quantity)||0,H=parseFloat(o.unitPrice)||0,Z=parseFloat(o.taxRate)||0,E=parseFloat(o.discount)||0,Y=f*H,je=o.discountType==="percentage"?Y*E/100:E,M=Y-je,J=M*(Z/100),Ne=M+J;return{...o,quantity:f,unitPrice:H,taxRate:Z,discount:E,subtotal:M,taxAmount:J,total:Ne}})},i=s.items.reduce((o,f)=>o+f.subtotal,0),x=s.items.reduce((o,f)=>o+f.taxAmount,0),$=i+x,g=$;s.subtotal=i,s.totalTax=x,s.totalAmount=$,s.balanceDue=g,s.amountPaid=0,(!s.relatedSale||s.relatedSale==="")&&delete s.relatedSale,(!s.relatedLead||s.relatedLead==="")&&delete s.relatedLead,console.log("Sending invoice data:",JSON.stringify(s,null,2));let D;I?(D=await p.update(I._id,s),m.success("Invoice updated successfully")):(D=await p.create(s),m.success("Invoice created successfully")),D.data.success&&(j(!1),F(null),B(),v())}catch(s){console.error("Error saving invoice:",s),m.error(((l=(t=s.response)==null?void 0:t.data)==null?void 0:l.message)||s.message||"Failed to save invoice")}finally{k(!1)}},B=()=>{u({companyInfo:{name:"Traincape Technology",logo:V,address:{street:"123 Tech Street",city:"Mumbai",state:"Maharashtra",zipCode:"400001",country:"India"},gstin:"27AABCT1234Z1Z5",pan:"AABCT1234G",email:"info@traincapetech.in",phone:"+91 98765 43210",website:"www.traincapetech.in"},clientInfo:{name:"",company:"",address:{street:"",city:"",state:"",zipCode:"",country:"India"},email:"",phone:""},paymentTerms:"Due on Receipt",customPaymentTerms:"",currency:"INR",currencySymbol:"₹",items:[{description:"",quantity:1,unitPrice:0,taxRate:18,discount:0,discountType:"percentage"}],notes:"",terms:"Payment is due within the specified terms. Late payments may incur additional charges.",relatedSale:"",relatedLead:""})},ye=a=>{var t,l;F(a),u({companyInfo:a.companyInfo,clientInfo:a.clientInfo,paymentTerms:a.paymentTerms,customPaymentTerms:a.customPaymentTerms||"",currency:a.currency,currencySymbol:a.currencySymbol,items:a.items,notes:a.notes||"",terms:a.terms||"",relatedSale:((t=a.relatedSale)==null?void 0:t._id)||"",relatedLead:((l=a.relatedLead)==null?void 0:l._id)||""}),j(!0)},be=async a=>{var t,l;if(window.confirm("Are you sure you want to delete this invoice?"))try{console.log("Deleting invoice:",a);const s=await p.delete(a);console.log("Delete response:",s),s.data.success?(m.success("Invoice deleted successfully"),U(i=>i.filter(x=>x._id!==a)),v()):m.error(s.data.message||"Failed to delete invoice")}catch(s){console.error("Error deleting invoice:",s),m.error(((l=(t=s.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to delete invoice")}},pe=async a=>{try{const t=await p.downloadPDF(a),l=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(l),i=document.createElement("a");i.href=s,i.download=`Invoice-${a}.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(s),m.success("PDF downloaded successfully")}catch(t){console.error("Error downloading PDF:",t),m.error("Failed to download PDF")}},he=async a=>{try{const t=await p.generatePDF(a),l=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(l);window.open(s,"_blank"),window.URL.revokeObjectURL(s)}catch(t){console.error("Error viewing PDF:",t),m.error("Failed to view PDF")}},ge=async a=>{a.preventDefault();try{(await p.recordPayment(h._id,N)).data.success&&(m.success("Payment recorded successfully"),A(!1),R(null),b({amount:"",method:"Bank Transfer",reference:"",notes:""}),v())}catch(t){console.error("Error recording payment:",t),m.error("Failed to record payment")}},fe=a=>{switch(a){case"Draft":return"bg-gray-500";case"Sent":return"bg-blue-500";case"Paid":return"bg-green-500";case"Overdue":return"bg-red-500";case"Partially Paid":return"bg-yellow-500";case"Cancelled":return"bg-gray-700";default:return"bg-gray-500"}};return P&&T.length===0?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx($e,{size:"large",text:"Loading invoices..."})})}):e.jsx(_,{children:e.jsxs("div",{className:`p-6 ${n.container}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${n.textPrimary}`,children:"Invoice Management"}),e.jsx("p",{className:`text-sm ${n.textSecondary} mt-1`,children:"Create, manage, and track professional invoices"})]}),e.jsxs("button",{onClick:()=>j(!0),className:`mt-4 sm:mt-0 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 ${Re.smooth}`,children:[e.jsx(Q,{})," Create Invoice"]})]}),e.jsxs("div",{className:`mb-6 ${n.card} ${X.medium}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4",children:[e.jsx("h2",{className:`text-lg font-semibold ${n.textPrimary}`,children:"Filters"}),e.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[e.jsxs("button",{onClick:()=>le(!O),className:`px-4 py-2 rounded-lg flex items-center gap-2 ${n.buttonSecondary}`,children:[e.jsx(De,{})," Filters"]}),e.jsxs("button",{onClick:de,className:`px-4 py-2 rounded-lg flex items-center gap-2 ${n.buttonSecondary}`,children:[e.jsx(K,{})," Clear"]})]})]}),O&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Status"}),e.jsxs("select",{name:"status",value:y.status,onChange:S,className:`w-full px-3 py-2 border rounded-lg ${n.input}`,children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Sent",children:"Sent"}),e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Overdue",children:"Overdue"}),e.jsx("option",{value:"Partially Paid",children:"Partially Paid"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:y.startDate,onChange:S,className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:y.endDate,onChange:S,className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Client Email"}),e.jsx("input",{type:"email",name:"clientEmail",value:y.clientEmail,onChange:S,placeholder:"Search by email",className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Invoice Number"}),e.jsx("input",{type:"text",name:"invoiceNumber",value:y.invoiceNumber,onChange:S,placeholder:"Search by number",className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]})]})]}),e.jsxs("div",{className:`${n.card} ${X.medium}`,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b ${n.border}`,children:[e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Invoice #"}),e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Client"}),e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Date"}),e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Amount"}),e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Status"}),e.jsx("th",{className:`px-4 py-3 text-left ${n.textSecondary} font-medium`,children:"Actions"})]})}),e.jsx("tbody",{children:T.map(a=>e.jsxs("tr",{className:`border-b ${n.border} hover:bg-gray-50`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`font-medium ${n.textPrimary}`,children:a.invoiceNumber})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:`font-medium ${n.textPrimary}`,children:a.clientInfo.name}),e.jsx("div",{className:`text-sm ${n.textSecondary}`,children:a.clientInfo.email})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:`text-sm ${n.textSecondary}`,children:new Date(a.invoiceDate).toLocaleDateString()})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:`font-medium ${n.textPrimary}`,children:[a.currencySymbol,a.totalAmount.toFixed(2)]}),a.balanceDue>0&&e.jsxs("div",{className:`text-sm ${n.textSecondary}`,children:["Due: ",a.currencySymbol,a.balanceDue.toFixed(2)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium text-white ${fe(a.status)}`,children:a.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>he(a._id),className:`p-2 rounded-lg ${n.buttonSecondary}`,title:"View PDF",children:e.jsx(Pe,{})}),e.jsx("button",{onClick:()=>pe(a._id),className:`p-2 rounded-lg ${n.buttonSecondary}`,title:"Download PDF",children:e.jsx(ke,{})}),e.jsx("button",{onClick:()=>ye(a),className:`p-2 rounded-lg ${n.buttonSecondary}`,title:"Edit",children:e.jsx(Ie,{})}),a.balanceDue>0&&e.jsx("button",{onClick:()=>{R(a),A(!0)},className:`p-2 rounded-lg ${n.buttonSecondary}`,title:"Record Payment",children:e.jsx(Fe,{})}),e.jsx("button",{onClick:()=>be(a._id),className:"p-2 rounded-lg text-red-600 hover:bg-red-50",title:"Delete",children:e.jsx(W,{})})]})})]},a._id))})]})}),T.length===0&&!P&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:`text-lg ${n.textSecondary}`,children:"No invoices found"})})]}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto ${n.card}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:`text-xl font-semibold ${n.textPrimary}`,children:I?"Edit Invoice":"Create New Invoice"}),e.jsx("button",{onClick:()=>{j(!1),F(null),B()},className:`p-2 rounded-lg ${n.buttonSecondary}`,children:e.jsx(K,{})})]}),e.jsxs("form",{onSubmit:xe,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${n.textPrimary} mb-4`,children:"Company Information"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-2`,children:"Company Logo"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:r.companyInfo.logo,alt:"Company Logo",className:"w-16 h-16 object-contain border rounded-lg bg-white p-2",onError:a=>{a.target.style.display="none"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{const t=a.target.files[0];if(t){const l=new FileReader;l.onload=s=>{c("companyInfo","logo",s.target.result)},l.readAsDataURL(t)}},className:`w-full px-3 py-2 border rounded-lg ${n.input}`}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Upload a new logo or keep the default Traincape Technology logo"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Company Name"}),e.jsx("input",{type:"text",value:r.companyInfo.name,onChange:a=>c("companyInfo","name",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"GSTIN"}),e.jsx("input",{type:"text",value:r.companyInfo.gstin,onChange:a=>c("companyInfo","gstin",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"PAN"}),e.jsx("input",{type:"text",value:r.companyInfo.pan,onChange:a=>c("companyInfo","pan",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Company PAN number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Email"}),e.jsx("input",{type:"email",value:r.companyInfo.email,onChange:a=>c("companyInfo","email",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Phone"}),e.jsx("input",{type:"text",value:r.companyInfo.phone,onChange:a=>c("companyInfo","phone",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${n.textPrimary} mb-4`,children:"Client Address Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Client Name *"}),e.jsx("input",{type:"text",value:r.clientInfo.name,onChange:a=>c("clientInfo","name",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Client Company (Optional)"}),e.jsx("input",{type:"text",value:r.clientInfo.company,onChange:a=>c("clientInfo","company",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Client Email *"}),e.jsx("input",{type:"email",value:r.clientInfo.email,onChange:a=>c("clientInfo","email",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Client Phone"}),e.jsx("input",{type:"text",value:r.clientInfo.phone,onChange:a=>c("clientInfo","phone",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's phone number"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:`text-md font-semibold ${n.textPrimary} mb-3`,children:"Billing Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Street Address"}),e.jsx("input",{type:"text",value:r.clientInfo.address.street,onChange:a=>C("clientInfo","street",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's street address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"City"}),e.jsx("input",{type:"text",value:r.clientInfo.address.city,onChange:a=>C("clientInfo","city",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's city"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"State/Province"}),e.jsx("input",{type:"text",value:r.clientInfo.address.state,onChange:a=>C("clientInfo","state",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's state or province"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"ZIP/Postal Code"}),e.jsx("input",{type:"text",value:r.clientInfo.address.zipCode,onChange:a=>C("clientInfo","zipCode",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's ZIP or postal code"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Country"}),e.jsx("input",{type:"text",value:r.clientInfo.address.country,onChange:a=>C("clientInfo","country",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Client's country"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${n.textPrimary} mb-4`,children:"Invoice Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Payment Terms"}),e.jsxs("select",{value:r.paymentTerms,onChange:a=>c(null,"paymentTerms",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,children:[e.jsx("option",{value:"Due on Receipt",children:"Due on Receipt"}),e.jsx("option",{value:"Net 7",children:"Net 7"}),e.jsx("option",{value:"Net 15",children:"Net 15"}),e.jsx("option",{value:"Net 30",children:"Net 30"}),e.jsx("option",{value:"Net 45",children:"Net 45"}),e.jsx("option",{value:"Net 60",children:"Net 60"}),e.jsx("option",{value:"Custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Currency"}),e.jsx("select",{value:r.currency,onChange:a=>c(null,"currency",a.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,children:Object.entries(L).map(([a,t])=>e.jsxs("option",{value:a,children:[a," (",t.symbol,") - ",t.name]},a))})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold ${n.textPrimary}`,children:"Line Items"}),e.jsxs("button",{type:"button",onClick:ce,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Q,{className:"inline mr-2"}),"Add Item"]})]}),e.jsx("div",{className:"space-y-4",children:r.items.map((a,t)=>e.jsxs("div",{className:`p-4 border rounded-lg ${n.border}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Description *"}),e.jsx("input",{type:"text",value:a.description,onChange:l=>w(t,"description",l.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Qty"}),e.jsx("input",{type:"number",min:"0.01",step:"0.01",value:a.quantity||0,onChange:l=>w(t,"quantity",l.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Unit Price"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.unitPrice||0,onChange:l=>w(t,"unitPrice",l.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Tax %"}),e.jsx("input",{type:"number",min:"0",max:"100",value:a.taxRate||0,onChange:l=>w(t,"taxRate",l.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Discount"}),e.jsx("input",{type:"number",min:"0",value:a.discount||0,onChange:l=>w(t,"discount",l.target.value),className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),r.items.length>1&&e.jsx("button",{type:"button",onClick:()=>me(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(W,{})})]})]}),e.jsx("div",{className:"mt-2 text-right",children:e.jsxs("span",{className:`text-sm ${n.textSecondary}`,children:["Total: ",r.currencySymbol,z(a).toFixed(2)]})})]},t))})]}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-xl font-bold ${n.textPrimary}`,children:["Total: ",r.currencySymbol,ue().toFixed(2)]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:a=>c(null,"notes",a.target.value),rows:"3",className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Terms & Conditions"}),e.jsx("textarea",{value:r.terms,onChange:a=>c(null,"terms",a.target.value),rows:"3",className:`w-full px-3 py-2 border rounded-lg ${n.input}`})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),F(null),B()},className:`px-6 py-2 rounded-lg ${n.buttonSecondary}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:P,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:P?"Saving...":I?"Update Invoice":"Create Invoice"})]})]})]})}),ae&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`bg-white rounded-lg shadow-xl max-w-md w-full ${n.card}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:`text-xl font-semibold ${n.textPrimary}`,children:"Record Payment"}),e.jsx("button",{onClick:()=>{A(!1),R(null),b({amount:"",method:"Bank Transfer",reference:"",notes:""})},className:`p-2 rounded-lg ${n.buttonSecondary}`,children:e.jsx(K,{})})]}),e.jsxs("form",{onSubmit:ge,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Invoice Number"}),e.jsx("input",{type:"text",value:h.invoiceNumber,className:`w-full px-3 py-2 border rounded-lg ${n.input} bg-gray-50`,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Balance Due"}),e.jsx("input",{type:"text",value:`${h.currencySymbol}${h.balanceDue.toFixed(2)}`,className:`w-full px-3 py-2 border rounded-lg ${n.input} bg-gray-50`,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Payment Amount *"}),e.jsx("input",{type:"number",min:"0.01",max:h.balanceDue,step:"0.01",value:N.amount,onChange:a=>b(t=>({...t,amount:parseFloat(a.target.value)})),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Payment Method *"}),e.jsxs("select",{value:N.method,onChange:a=>b(t=>({...t,method:a.target.value})),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,required:!0,children:[e.jsx("option",{value:"Cash",children:"Cash"}),e.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"Cheque",children:"Cheque"}),e.jsx("option",{value:"Credit Card",children:"Credit Card"}),e.jsx("option",{value:"Debit Card",children:"Debit Card"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Reference Number"}),e.jsx("input",{type:"text",value:N.reference,onChange:a=>b(t=>({...t,reference:a.target.value})),className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Transaction ID, Cheque number, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-1`,children:"Notes"}),e.jsx("textarea",{value:N.notes,onChange:a=>b(t=>({...t,notes:a.target.value})),rows:"3",className:`w-full px-3 py-2 border rounded-lg ${n.input}`,placeholder:"Additional payment notes..."})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{A(!1),R(null),b({amount:"",method:"Bank Transfer",reference:"",notes:""})},className:`px-6 py-2 rounded-lg ${n.buttonSecondary}`,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Record Payment"})]})]})]})})]})})};export{Ke as default};
